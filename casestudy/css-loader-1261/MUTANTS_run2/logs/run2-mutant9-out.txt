
> css-loader@5.0.1 test
> npm run test:coverage


> css-loader@5.0.1 test:coverage
> npm run test:only -- --collectCoverageFrom="src/**/*.js" --coverage


> css-loader@5.0.1 test:only
> cross-env NODE_ENV=test jest --collectCoverageFrom=src/**/*.js --coverage

PASS test/runtime/getUrl.test.js
PASS test/runtime/api.test.js
PASS test/cjs.test.js
FAIL test/import-option.test.js
  ● "import" option › should work when not specified

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/import-option.test.js:18:12)

  ● "import" option › should work with a value equal to "true"

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/import-option.test.js:32:12)

  ● "import" option › should work when "Function"

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/import-option.test.js:77:12)

 › 12 snapshots obsolete.
   • "import" option should work when "Function": errors 1
   • "import" option should work when "Function": module 1
   • "import" option should work when "Function": result 1
   • "import" option should work when "Function": warnings 1
   • "import" option should work when not specified: errors 1
   • "import" option should work when not specified: module 1
   • "import" option should work when not specified: result 1
   • "import" option should work when not specified: warnings 1
   • "import" option should work with a value equal to "true": errors 1
   • "import" option should work with a value equal to "true": module 1
   • "import" option should work with a value equal to "true": result 1
   • "import" option should work with a value equal to "true": warnings 1
FAIL test/url-option.test.js
  ● "url" option › should work when not specified

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/url-option.test.js:22:12)

  ● "url" option › should work with a value equal to "true"

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/url-option.test.js:34:12)

  ● "url" option › should resolve absolute path

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/url-option.test.js:105:12)

  ● "url" option › should work with the 'asset' type of asset modules

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/url-option.test.js:189:12)

  ● "url" option › should work with the 'asset/resource' type of asset modules

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/url-option.test.js:235:12)

  ● "url" option › should work with the 'asset/inline' type of asset modules

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/url-option.test.js:274:12)

 › 24 snapshots obsolete.
   • "url" option should resolve absolute path: errors 1
   • "url" option should resolve absolute path: module 1
   • "url" option should resolve absolute path: result 1
   • "url" option should resolve absolute path: warnings 1
   • "url" option should work when not specified: errors 1
   • "url" option should work when not specified: module 1
   • "url" option should work when not specified: result 1
   • "url" option should work when not specified: warnings 1
   • "url" option should work with a value equal to "true": errors 1
   • "url" option should work with a value equal to "true": module 1
   • "url" option should work with a value equal to "true": result 1
   • "url" option should work with a value equal to "true": warnings 1
   • "url" option should work with the 'asset' type of asset modules: errors 1
   • "url" option should work with the 'asset' type of asset modules: module 1
   • "url" option should work with the 'asset' type of asset modules: result 1
   • "url" option should work with the 'asset' type of asset modules: warnings 1
   • "url" option should work with the 'asset/inline' type of asset modules: errors 1
   • "url" option should work with the 'asset/inline' type of asset modules: module 1
   • "url" option should work with the 'asset/inline' type of asset modules: result 1
   • "url" option should work with the 'asset/inline' type of asset modules: warnings 1
   • "url" option should work with the 'asset/resource' type of asset modules: errors 1
   • "url" option should work with the 'asset/resource' type of asset modules: module 1
   • "url" option should work with the 'asset/resource' type of asset modules: result 1
   • "url" option should work with the 'asset/resource' type of asset modules: warnings 1
PASS test/esModule-option.test.js
PASS test/validate-options.test.js
PASS test/importLoaders-option.test.js
  ● Console

    console.warn
      Browserslist: caniuse-lite is outdated. Please run:
      npx browserslist@latest --update-db
      
      Why you should do it regularly:
      https://github.com/browserslist/browserslist#browsers-data-updating

      28 |                   options: {
      29 |                     postcssOptions: {
    > 30 |                       plugins: [postcssPresetEnv({ stage: 0 })],
         |                                 ^
      31 |                     },
      32 |                   },
      33 |                 },

      at Object.oldDataWarning (node_modules/browserslist/node.js:373:15)
      at browserslist (node_modules/browserslist/index.js:432:7)
      at node_modules/postcss-preset-env/src/postcss.js:87:28
      at creator (node_modules/postcss-preset-env/node_modules/postcss/lib/postcss.es6:111:34)
      at Object.<anonymous> (test/importLoaders-option.test.js:30:33)

PASS test/loader.test.js (5.496 s)
  ● Console

    console.warn
      Browserslist: caniuse-lite is outdated. Please run:
      npx browserslist@latest --update-db
      
      Why you should do it regularly:
      https://github.com/browserslist/browserslist#browsers-data-updating

      11 |   const { spy = jest.fn() } = this.query;
      12 |
    > 13 |   postcss([postcssPresetEnv({ stage: 0 })])
         |            ^
      14 |     .process(content, {
      15 |       // eslint-disable-next-line no-undefined
      16 |       from: undefined,

      at Object.oldDataWarning (node_modules/browserslist/node.js:373:15)
      at browserslist (node_modules/browserslist/index.js:432:7)
      at node_modules/postcss-preset-env/src/postcss.js:87:28
      at creator (node_modules/postcss-preset-env/node_modules/postcss/lib/postcss.es6:111:34)
      at Object.astLoader (test/helpers/ast-loader.js:13:12)
      at LOADER_EXECUTION (node_modules/loader-runner/lib/LoaderRunner.js:132:14)
      at runSyncOrAsync (node_modules/loader-runner/lib/LoaderRunner.js:133:4)
      at iterateNormalLoaders (node_modules/loader-runner/lib/LoaderRunner.js:250:2)

PASS test/sourceMap-option.test.js (5.838 s)
  ● Console

    console.warn
      Browserslist: caniuse-lite is outdated. Please run:
      npx browserslist@latest --update-db
      
      Why you should do it regularly:
      https://github.com/browserslist/browserslist#browsers-data-updating

      319 |                     options: {
      320 |                       postcssOptions: {
    > 321 |                         plugins: [postcssPresetEnv({ stage: 0 })],
          |                                   ^
      322 |                       },
      323 |                       sourceMap: true,
      324 |                     },

      at Object.oldDataWarning (node_modules/browserslist/node.js:373:15)
      at browserslist (node_modules/browserslist/index.js:432:7)
      at node_modules/postcss-preset-env/src/postcss.js:87:28
      at creator (node_modules/postcss-preset-env/node_modules/postcss/lib/postcss.es6:111:34)
      at Object.<anonymous> (test/sourceMap-option.test.js:321:35)

FAIL test/modules-option.test.js (9.816 s)
  ● "modules" option › should support resolving in composes

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/modules-option.test.js:303:7)

  ● "modules" option › should work and respect the "exportOnlyLocals" option

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/modules-option.test.js:1082:7)

  ● "modules" option › should work with "exportOnlyLocals" and "esModule" with "true" value options

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/modules-option.test.js:1103:7)

  ● "modules" option › should work with "exportOnlyLocals" and "esModule" with "false" value options

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/modules-option.test.js:1124:7)

  ● "modules" option › should work with "exportOnlyLocals" and "namedExport" option

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/modules-option.test.js:1311:7)

  ● "modules" option › show work with the "compileType" option using the "module" value

    TypeError: Cannot read properties of undefined (reading 'replace')

       5 |
       6 |   // Todo remove after drop webpack@4 support
    >  7 |   source = source.replace(/\?\?.*!/g, "??[ident]!");
         |                   ^
       8 |
       9 |   return source;
      10 | };

      at _default (test/helpers/getModuleSource.js:7:19)
      at Object.<anonymous> (test/modules-option.test.js:1436:7)

 › 24 snapshots obsolete.
   • "modules" option should support resolving in composes: errors 1
   • "modules" option should support resolving in composes: module 1
   • "modules" option should support resolving in composes: result 1
   • "modules" option should support resolving in composes: warnings 1
   • "modules" option should work and respect the "exportOnlyLocals" option: errors 1
   • "modules" option should work and respect the "exportOnlyLocals" option: module 1
   • "modules" option should work and respect the "exportOnlyLocals" option: result 1
   • "modules" option should work and respect the "exportOnlyLocals" option: warnings 1
   • "modules" option should work with "exportOnlyLocals" and "esModule" with "false" value options: errors 1
   • "modules" option should work with "exportOnlyLocals" and "esModule" with "false" value options: module 1
   • "modules" option should work with "exportOnlyLocals" and "esModule" with "false" value options: result 1
   • "modules" option should work with "exportOnlyLocals" and "esModule" with "false" value options: warnings 1
   • "modules" option should work with "exportOnlyLocals" and "esModule" with "true" value options: errors 1
   • "modules" option should work with "exportOnlyLocals" and "esModule" with "true" value options: module 1
   • "modules" option should work with "exportOnlyLocals" and "esModule" with "true" value options: result 1
   • "modules" option should work with "exportOnlyLocals" and "esModule" with "true" value options: warnings 1
   • "modules" option should work with "exportOnlyLocals" and "namedExport" option: errors 1
   • "modules" option should work with "exportOnlyLocals" and "namedExport" option: module 1
   • "modules" option should work with "exportOnlyLocals" and "namedExport" option: result 1
   • "modules" option should work with "exportOnlyLocals" and "namedExport" option: warnings 1
   • "modules" option show work with the "compileType" option using the "module" value: errors 1
   • "modules" option show work with the "compileType" option using the "module" value: module 1
   • "modules" option show work with the "compileType" option using the "module" value: result 1
   • "modules" option show work with the "compileType" option using the "module" value: warnings 1
----------------------------|---------|----------|---------|---------|--------------------
File                        | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s  
----------------------------|---------|----------|---------|---------|--------------------
All files                   |   99.13 |    94.18 |     100 |   99.13 |                    
 src                        |    98.4 |    92.89 |     100 |    98.4 |                    
  CssSyntaxError.js         |     100 |       50 |     100 |     100 | 13-22              
  Warning.js                |     100 |       50 |     100 |     100 | 11                 
  cjs.js                    |     100 |      100 |     100 |     100 |                    
  index.js                  |     100 |      100 |     100 |     100 |                    
  utils.js                  |   97.91 |    93.58 |     100 |   97.91 | 88,364,418,472,478 
 src/plugins                |     100 |    95.28 |     100 |     100 |                    
  index.js                  |       0 |        0 |       0 |       0 |                    
  postcss-icss-parser.js    |     100 |    81.82 |     100 |     100 | 5,53               
  postcss-import-parser.js  |     100 |    95.24 |     100 |     100 | 76,166             
  postcss-url-parser.js     |     100 |    98.11 |     100 |     100 | 115                
 src/runtime                |     100 |      100 |     100 |     100 |                    
  api.js                    |     100 |      100 |     100 |     100 |                    
  cssWithMappingToString.js |     100 |      100 |     100 |     100 |                    
  getUrl.js                 |     100 |      100 |     100 |     100 |                    
----------------------------|---------|----------|---------|---------|--------------------
Snapshot Summary
 › 60 snapshots obsolete from 3 test suites. To remove them all, run `npm run test:only -- -u`.
   ↳ test/import-option.test.js
       • "import" option should work when "Function": errors 1
       • "import" option should work when "Function": module 1
       • "import" option should work when "Function": result 1
       • "import" option should work when "Function": warnings 1
       • "import" option should work when not specified: errors 1
       • "import" option should work when not specified: module 1
       • "import" option should work when not specified: result 1
       • "import" option should work when not specified: warnings 1
       • "import" option should work with a value equal to "true": errors 1
       • "import" option should work with a value equal to "true": module 1
       • "import" option should work with a value equal to "true": result 1
       • "import" option should work with a value equal to "true": warnings 1
   ↳ test/url-option.test.js
       • "url" option should resolve absolute path: errors 1
       • "url" option should resolve absolute path: module 1
       • "url" option should resolve absolute path: result 1
       • "url" option should resolve absolute path: warnings 1
       • "url" option should work when not specified: errors 1
       • "url" option should work when not specified: module 1
       • "url" option should work when not specified: result 1
       • "url" option should work when not specified: warnings 1
       • "url" option should work with a value equal to "true": errors 1
       • "url" option should work with a value equal to "true": module 1
       • "url" option should work with a value equal to "true": result 1
       • "url" option should work with a value equal to "true": warnings 1
       • "url" option should work with the 'asset' type of asset modules: errors 1
       • "url" option should work with the 'asset' type of asset modules: module 1
       • "url" option should work with the 'asset' type of asset modules: result 1
       • "url" option should work with the 'asset' type of asset modules: warnings 1
       • "url" option should work with the 'asset/inline' type of asset modules: errors 1
       • "url" option should work with the 'asset/inline' type of asset modules: module 1
       • "url" option should work with the 'asset/inline' type of asset modules: result 1
       • "url" option should work with the 'asset/inline' type of asset modules: warnings 1
       • "url" option should work with the 'asset/resource' type of asset modules: errors 1
       • "url" option should work with the 'asset/resource' type of asset modules: module 1
       • "url" option should work with the 'asset/resource' type of asset modules: result 1
       • "url" option should work with the 'asset/resource' type of asset modules: warnings 1
   ↳ test/modules-option.test.js
       • "modules" option should support resolving in composes: errors 1
       • "modules" option should support resolving in composes: module 1
       • "modules" option should support resolving in composes: result 1
       • "modules" option should support resolving in composes: warnings 1
       • "modules" option should work and respect the "exportOnlyLocals" option: errors 1
       • "modules" option should work and respect the "exportOnlyLocals" option: module 1
       • "modules" option should work and respect the "exportOnlyLocals" option: result 1
       • "modules" option should work and respect the "exportOnlyLocals" option: warnings 1
       • "modules" option should work with "exportOnlyLocals" and "esModule" with "false" value options: errors 1
       • "modules" option should work with "exportOnlyLocals" and "esModule" with "false" value options: module 1
       • "modules" option should work with "exportOnlyLocals" and "esModule" with "false" value options: result 1
       • "modules" option should work with "exportOnlyLocals" and "esModule" with "false" value options: warnings 1
       • "modules" option should work with "exportOnlyLocals" and "esModule" with "true" value options: errors 1
       • "modules" option should work with "exportOnlyLocals" and "esModule" with "true" value options: module 1
       • "modules" option should work with "exportOnlyLocals" and "esModule" with "true" value options: result 1
       • "modules" option should work with "exportOnlyLocals" and "esModule" with "true" value options: warnings 1
       • "modules" option should work with "exportOnlyLocals" and "namedExport" option: errors 1
       • "modules" option should work with "exportOnlyLocals" and "namedExport" option: module 1
       • "modules" option should work with "exportOnlyLocals" and "namedExport" option: result 1
       • "modules" option should work with "exportOnlyLocals" and "namedExport" option: warnings 1
       • "modules" option show work with the "compileType" option using the "module" value: errors 1
       • "modules" option show work with the "compileType" option using the "module" value: module 1
       • "modules" option show work with the "compileType" option using the "module" value: result 1
       • "modules" option show work with the "compileType" option using the "module" value: warnings 1

Test Suites: 3 failed, 8 passed, 11 total
Tests:       15 failed, 432 passed, 447 total
Snapshots:   60 obsolete, 1417 passed, 1417 total
Time:        10.48 s, estimated 11 s
Ran all test suites.
